Title: Sum of Three CubesDate: 2025-01-16 18:00Author: AmirCategory: MathSummary: Finding solutions for the sum of three cubes problem.# Finding solutions for the sum of three cubes problem.The sum of three cubes prolem asks if a whole number $a > 0$ can be written as the sum of three cubes. Ive heard about it the first time from a very famous [Numberphile video](https://www.numberphile.com/videos/the-uncracked-problem-with-33) by Brady Haran and Timothy Browning. Basically, given one whole number $a$, it asks for whole numbers $x,y,z$ such that$$    a = x^3 + y^3 + z^3.$$Here $x,y,z$ can also be negative since cubing a number does not affect its sign, so for a certain $a$ there can exist solutions with $x,y$ and $z$ much larger than $a$ itself.For example, for the number three there are only three solutions known at the moment of writing. The first two of these are$$    3 = 1^3 + 1^3 + 1^3 \\    3 = -5^3 + 4^3 + 4^3.$$But the [third solution was only found in September of 2019 by Booker and Sutherland](https://blogs.ams.org/beyondreviews/2019/09/18/3/#more-2526) and its given by$$    3 = 569'936'821'221'962'380'720^3-569'936'821'113'563'493'509^3-472'715'493'453'327'032^3,$$which is an absolutely humongous result. This is also what makes the sum of three cubes problem so interesting, there is still no proof that every number can be written in this form and even if a solution is found, we do not even know if there are still more lurking around. In order to find solutions for some specific $a$, we could just try all combinations of $x,y,z$, this is very inefficient since if we want to test all combinations up to $n = x_\text{max} = y_\text{max} = z_\text{max}$, we would need to perform $n*n*n$ checks and permute the signs $8$ times. _This is basically the worst case implementation, with complexity $\mathcal{O}(n^3)$_ because for checking up to $n = 1000$ this means our program has to run $8'000'000'000$ times.A little bit more efficient would be the following approach: We could basically just test combinations of $x,y$ and ask if the cube root of $x^3+y^3-a$ is a whole number. In this case, this means that this algorithm has to perform $\mathcal{O}(n^2)$ checks, which is much better than cubic complexity, but there is an even better method.# Checking for a sum of two three cubes using divisors.Say we want to find nontrivial solutions, where the search space is not confined to $a>x^3,y^3,z^3 > 0$. As these solutions would be simple solutions like$$2^3 + 0^3 + 0^3 = 8$$or$$3^3 + 2^3 + 1^3 = 36.$$I will not count those, since for a given $a$ thre is only a relatively small finite number of them and we would just have to perform $(\sqrt[3]{a})^2$ checks. So, there are always only a finite number of them and the complexity is $\mathcal{O}(a^{2/3})$. This space of solutions is trivial to search.## Which combinations to search for._The much more interesting cases, with large number solutions $x,y,z$ that are larger than $a$ arise when their signs are not all positive._Lets write $x > y > z > a > 0$, we can have 8 possible arrangements of signs, of which we can eliminate most:$$a < 3 z^3 < x^3 + y^3 + z^3 = a $$This case we have discussed before.$$a < x^3 < x^3 + (y^3 - z^3) = a \\a < z^3 < (x^3 - y^3) + z^3 = a $$The number $a$ cannot be greater than itself, so these two sign arrangements are impossible.$$x^3 - y^3 - z^3 = a \\-x^3 + y^3 + z^3 = a $$We can expect to have to search for both of these cases.$$0 > (-x^3 + x^3) - z^3> -x^3 + y^3 - z^3 = a \\0 > -(x^3+[y^3-z^3]) > -x^3 - y^3 + z^3 = a \\0 > -x^3 - y^3 - z^3 = a$$All of these are impossible as well.So there are only solutions left of the form$$\pm x^3 \mp y^3 \mp z^3 = a$$where $x > y > z > a > 0$. This means, that for $x,y,z \to \infty$ these two are the only sign choices that are allowed.## The divisor trick.Given $a$, lets try to test for a specific $z$, which is the smallest of the three numbers $x,y,z$. For this, define$$    A := z^3 \pm a > 0$$In both cases $\pm$ we have that $A \triangleq x^3 - y^3$, which we rewrite as$$    (x - y)^3 + 3 xy (x-y)$$Introducing $\alpha = xy$ and $\beta = x - y$, we see that$$ \beta \, | A = \beta (\beta^2 + 3\alpha)$$So, $\beta$ is one of the divisors of $A$, this is a great hint in order to search for $x,y$ such that $A = x^3 - y^3$ without testing through any combinations of $x$ and $y$.Now, with $\alpha,\beta$ we have that$$    x^2 - \beta x + \alpha = 0,$$and now, a real solution for $x$ exists in case that $\omega^2 = \beta^2 + 4 \alpha > 0$.  We also have that$$    x = \frac{\omega + \beta}{2} \\    y = \frac{\omega - \beta}{2},$$because we defined $\beta = x - y$ and $\omega^2 = (x-y)^2 + 4 \alpha = (x+y)^2$.We now have to try to eliminate the need for the very large variable $\alpha$, since it is the *product* between $x$ and $y$. First, we can calculate it as$$    \alpha \triangleq \frac{1}{3} \left[\gamma - \beta^2 \right],$$where $\gamma := \frac{A}{\beta}$.Second, in terms of $\omega$ it is given by$$    \alpha = \frac{\beta^2 - \omega^2}{4}.$$Therefore, combining both relations yields$$    \beta^2 + 3 \omega^2 - 4 \gamma = 0,$$which has one solution $\omega$ that is greater than zero:$$    \omega = \sqrt{\frac{4 \gamma - \beta^2}{3}}$$If this $\omega$ is an integer, we can get integer solutions to $x$ and $y$. So, we only have to check if $\frac{4 \gamma - \beta^2}{3}$ is a perfect square.## Describing the algorithm.Putting all of this together, the procedure to find a non-trivial solution $$\pm x^3 \mp y^3 \mp z^3 = a$$for a predefined $a$ is as follows:> * Fix a positive whole number $z$.> * Generate a list of divisors $\beta$ for $A = z^3 \pm a$.> * For every $\beta$ check if $\frac{4 \gamma - \beta^2}{3}$ is a perfect square $\omega^2$.> * Determine $x$ and $y$ from $\omega$ and $\beta$._By this, a triplet $x,y,z$ with $x>y>z>a$ can be found that is a solution to the sum of three cubes problem. Exciting isnt it?_Depending on how the divisor search is implemented we can also try to estimate the complexity of this solution search. In case the factorization step needs $\mathcal{O}(\sqrt{n})$ operations and considering that we would have to repeat this for every $z$ that we try, we get a complexity of $\mathcal{O}(n^{1.5})$ operations. This is for searching for a solution $x,y,z$ with $n=\mathrm{min}(x,y,z)$. Making this method faster than the two naive approaches from the beginning.